$(function(){var t=1,e=.5,a=5,n="USD",o=[],r=18e5,i="https://steembottracker.net",s={},l=null,c=null,d={},m=[],u=[],_=!0;function p(t){$.get("https://postpromoter.net/api/prices",function(e){steem_price=parseFloat(e.steem_price),sbd_price=parseFloat(e.sbd_price),token_prices=e.se_token_prices,$("#steem_price").text(steem_price.formatMoney()),$("#sbd_price").text(sbd_price.formatMoney()),t&&t()})}function f(){$.get(i+"/other_bots",function(t){t.sort(function(t,e){return e.vote_value-t.vote_value});var e=$("#other_table tbody");e.empty();for(var a=0;a<t.length;a++){var n=t[a],o=$(document.createElement("tr")),r=$('<td><a target="_blank" href="https://steemit.com/@'+n.name+'">@'+n.name+"</a></td>");o.append(r),r=$("<td>$"+n.vote_value.toFixed(2)+"</td>"),o.append(r),r=$("<td>"+(n.profile.about?n.profile.about:"")+"</td>"),o.append(r),r=$("<td>"+(n.profile.website?'<a target="_blank" href="'+n.profile.website+'">'+n.profile.website+"</a>":"")+"</td>"),o.append(r),e.append(o)}})}function g(){$.get(i+"/bid_bots",function(t){(o=t.filter(t=>t.vote_usd>.1&&t.last<36e6)).map(function(t){return t.name}).sort().forEach(function(t){$("#bot_list").append('<option value="'+t+'">'+t+"</option>")}),h()})}function b(){steem.api.getAccounts(["booster","minnowbooster","tipu","therising"],function(t,e){try{var a=e[0],n=JSON.parse(a.json_metadata),o=$("#booster-progress div"),r=getVotingPower(a)/100;o.attr("aria-valuenow",r),o.css("width",r+"%"),o.text(r+"%"),$("#booster-vote").text("$"+getVoteValue(100,a).formatMoney()),$("#booster_bot_error").css("display","none"),a=e[1];o=$("#minnowbooster-progress div"),r=getVotingPower(a)/100;o.attr("aria-valuenow",r),o.css("width",r+"%"),o.text(r+"%"),$("#minnowbooster-vote").text("$"+getVoteValue(100,a).formatMoney()),$("#mb_bot_error").css("display","none"),a=e[2];n=JSON.parse(a.json_metadata);$("#tipu-desc").text(n.profile.about);o=$("#tipu-progress div"),r=getVotingPower(a)/100;o.attr("aria-valuenow",r),o.css("width",r+"%"),o.text(r+"%"),$("#tipu-vote").text("$"+getVoteValue(100,a).formatMoney()),$("#tipu_bot_error").css("display","none"),a=e[3];n=JSON.parse(a.json_metadata),o=$("#therising-progress div"),r=getVotingPower(a)/100;o.attr("aria-valuenow",r),o.css("width",r+"%"),o.text(r+"%"),$("#therising-vote").text("$"+getVoteValue(100,a).formatMoney()),$("#therising_bot_error").css("display","none")}catch(t){console.log(t),$("#ss_bot_error").css("display","block")}})}function h(){$("#bots_table tbody").empty();var t=o.filter(function(t){return m.indexOf(t.name)>=0}),e=o.filter(function(t){return m.indexOf(t.name)<0});if(t.sort(function(t,e){return(100==t.power&&t.last>3*HOURS||t.last<6e4?999e7:t.next)-(100==e.power&&e.last>3*HOURS||e.last<6e4?999e7:e.next)}),e.sort(function(t,e){return(100==t.power&&t.last>3*HOURS||t.last<6e4?999e7:t.next)-(100==e.power&&e.last>3*HOURS||e.last<6e4?999e7:e.next)}),t.length>0){t.forEach(v);var a=$(document.createElement("tr")),n=$(document.createElement("td"));n.attr("colspan","10"),n.html('<hr style="margin: 0;"/>'),a.append(n),$("#bots_table tbody").append(a)}e.forEach(v),$('[data-toggle="tooltip"]').tooltip(),u.length>0&&($("#bots_hidden").text(u.length),$("#unhide_link").show())}function v(o){try{var r=m.indexOf(o.name)>=0;if(!r&&(u.indexOf(o.name)>=0||o.vote_usd<a||s.verified&&!o.api_url||s.refund&&!o.refunds||s.steem&&!o.accepts_steem||s.se&&!o.se_token||s.nocomment&&(null==o.posts_comment||o.posts_comment)))return;let T=e*o.vote_usd-t*o.total_usd;var l=(e*o.vote_usd-t*o.total_usd)/sbd_price,c=o.accepts_steem?(e*o.vote_usd-t*o.total_usd)/steem_price:0;o.se_token&&token_prices[o.se_token]&&(T/=token_prices[o.se_token]*steem_price);var p=$(document.createElement("tr")),f=$(document.createElement("td"));(M=$(document.createElement("a"))).attr("href","http://www.steemit.com/@"+o.name),M.attr("target","_blank");var g="@"+o.name;if((100==o.power&&o.last>4*HOURS||o.power<90)&&(g+=" (DOWN)"),M.html("<img class='userpic' src='https://steemitimages.com/u/"+o.name+"/avatar'></img>"+g),f.append(M),o.comments){var b=$('<span class="fa fa-comment-o ml5" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Allows Comments"></span>');f.append(b)}if(null!=o.posts_comment&&!o.posts_comment){b=$('<img src="img/no_comment.png" style="width: 20px; margin-left: 5px;" data-toggle="tooltip" data-placement="top" title="This bot does not post a comment when it votes on a post." />');f.append(b)}if(o.accepts_steem){b=$('<img src="img/steem.png" style="width: 20px; margin-left: 5px;" data-toggle="tooltip" data-placement="top" title="This bot accepts STEEM bids!" />');f.append(b)}if(o.se_token){b=$('<img src="img/steem_engine_logo_32.png" style="width: 20px; margin-left: 5px;" data-toggle="tooltip" data-placement="top" title="This bot only accepts the '+o.se_token+' Steem Engine token." />');f.append(b)}if(o.refunds){b=$('<img src="img/refund.png" style="width: 20px; margin-left: 5px;" data-toggle="tooltip" data-placement="top" title="This bot automatically refunds invalid bids!" />');f.append(b)}p.append(f),(f=$(document.createElement("td"))).text(x(o)),p.append(f),f=$(document.createElement("td"));var v=$("<span>");o.max_bid&&o.max_bid_wl&&parseFloat(o.max_bid_wl)>parseFloat(o.max_bid)&&(v.attr("data-toggle","tooltip"),v.attr("data-placement","top"),v.attr("title","This bot has a higher max bid for whitelisted accounts.")),v.html((o.min_bid?o.min_bid.toFixed(2):"--")+(o.max_bid?" / "+o.max_bid.toFixed(2):"")+(o.max_bid_wl?"*":"")),f.append(v),p.append(f),(f=$(document.createElement("td"))).text((o.fill_limit?(100*(1-o.fill_limit)).toFixed()+"%":"none")+" / "+(o.max_roi?o.max_roi+"%":"none")),p.append(f),(f=$(document.createElement("td"))).text((o.min_post_age?o.min_post_age:0)+" mins / "+(o.max_post_age?o.max_post_age+" days":"unknown")),p.append(f),(f=$(document.createElement("td"))).text(isNaN(o.total_usd)?"--":function(t){switch(n){case"SBD":return(t.total_usd/sbd_price).formatMoney()+" SBD";case"STEEM":return(t.total_usd/steem_price).formatMoney()+" STEEM";case"USD":return"$"+t.total_usd.formatMoney();case"POST REWARDS":return"$"+(t.total_usd/t.vote_usd*t.vote).formatMoney()}}(o)),p.append(f),f=$(document.createElement("td")),isNaN(o.total_usd)?f.text("unknown"):o.se_token?f.text(Math.max(T,0).formatMoney()+" "+o.se_token):o.accepts_steem?f.html(Math.max(c,0).formatMoney()+' <img src="img/steem.png" style="width: 17px; vertical-align: top;"/> or '+Math.max(l,0).formatMoney()+" SBD"):f.text(Math.max(l,0).formatMoney()+" SBD"),p.append(f),(f=$(document.createElement("td"))).addClass("timer"),f.attr("dir","up"),f.attr("time",o.last),f.text(toTimer(o.last)),p.append(f),(f=$(document.createElement("td"))).addClass("timer"),f.attr("time",o.next),f.text(toTimer(o.next)),p.append(f),f=$(document.createElement("td"));var S=$('<div class="dropdown"><button class="btn btn-xs btn-warning dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Actions&nbsp;<span class="caret"></span></button></div>'),k=$('<ul class="actions dropdown-menu dropdown-menu-right" aria-labelledby="dLabel"></ul>');if(!isNaN(o.total_usd))(M=$('<li><a href="javascript:void(0);"><i class="fa fa-eye mr5"></i>Details</a></li>')).click(function(t){!function(t){$("#bid_details_bot").text(t.name),$("#bid_details_table_cur tbody").empty(),$("#bid_details_table_last tbody").empty(),$("#cur_round_vote").text("Loading..."),$("#cur_round_bids").text("Loading..."),$("#cur_round_value").text("Loading..."),$("#cur_round_roi").text("Loading..."),$("#last_round_vote").text("Loading..."),$("#last_round_bids").text("Loading..."),$("#last_round_value").text("Loading..."),$("#last_round_roi").text("Loading..."),$.get(i+"/bid_bots/"+t.name,function(a){var n=$("#bid_details_table_cur tbody");n.empty();var o=$("#bid_details_table_last tbody");if(o.empty(),a&&a.current_round){a.current_round.round_total=a.current_round.reduce(function(t,e){return t+getUsdValue(e)},0),w(n,t,a.current_round),$("#cur_round_vote").text(x(t)+" ("+t.interval/2.4*100+"%)"),t.se_token?$("#cur_round_bids").text(y(a.current_round,t.se_token).formatMoney()+" "+t.se_token):$("#cur_round_bids").text(y(a.current_round,"SBD").formatMoney()+" SBD"+(t.accepts_steem?" & "+y(a.current_round,"STEEM").formatMoney()+" STEEM":"")),$("#cur_round_value").text("$"+t.total_usd.formatMoney());var r=100*(t.vote_usd*e/a.current_round.round_total-1);t.max_roi&&(r=Math.min(t.max_roi,r)),$("#cur_round_roi").text(r.formatMoney()+"% (After Curation"+(t.max_roi?" - Capped)":")"))}if(a&&a.last_round){a.last_round.round_total=a.last_round.reduce(function(t,e){return t+getUsdValue(e)},0),w(o,t,a.last_round),$("#last_round_vote").text(x(t)+" ("+t.interval/2.4*100+"%)"),t.se_token?$("#last_round_bids").text(y(a.last_round,t.se_token).formatMoney()+" "+t.se_token):$("#last_round_bids").text(y(a.last_round,"SBD").formatMoney()+" SBD"+(t.accepts_steem?" & "+y(a.last_round,"STEEM").formatMoney()+" STEEM":"")),$("#last_round_value").text("$"+a.last_round.round_total.formatMoney());var r=100*(t.vote_usd*e/a.last_round.round_total-1);t.max_roi&&(r=Math.min(t.max_roi,r)),$("#last_round_roi").text(r.formatMoney()+"% (After Curation"+(t.max_roi?" - Capped)":")"))}$("#cur_round_show").click(function(t){$("#cur_round").show(),$("#cur_round_show").parent().addClass("active"),$("#last_round").hide(),$("#last_round_show").parent().removeClass("active")}),$("#last_round_show").click(function(t){$("#cur_round").hide(),$("#cur_round_show").parent().removeClass("active"),$("#last_round").show(),$("#last_round_show").parent().addClass("active")})}),$("#bid_details").modal()}(o)}),k.append(M);if((M=$('<li><a href="javascript:void(0);"><i class="fa fa-upload mr5"></i>Send Bid</a></li>')).click(function(t){E(o)}),k.append(M),r)(M=$('<li><a href="javascript:void(0);"><i class="fa fa-heart mr5" style="color: red;"></i>Un-Favorite</a></li>')).click(function(t){m.splice(m.indexOf(o.name),1),localStorage.setItem("favorites",m.join()),h()}),k.append(M);else(M=$('<li><a href="javascript:void(0);"><i class="fa fa-heart mr5" style="color: red;"></i>Favorite</a></li>')).click(function(t){m.push(o.name),localStorage.setItem("favorites",m.join()),h()}),k.append(M);if(u.indexOf(o.name)>=0)(M=$('<li><a href="javascript:void(0);"><i class="fa fa-remove mr5"></i>Un-Hide</a></li>')).click(function(t){u.splice(u.indexOf(o.name),1),localStorage.setItem("hidden",u.join()),h()}),k.append(M);else(M=$('<li><a href="javascript:void(0);"><i class="fa fa-remove mr5"></i>Hide</a></li>')).click(function(t){u.push(o.name),localStorage.setItem("hidden",u.join()),h()}),k.append(M);if(o.rules_url&&""!=o.rules_url){var M=$('<li><a href="'+o.rules_url+'" target="_blank"><i class="fa fa-list-alt mr5"></i>Terms of Service</a></li>');k.append(M)}S.append(k),f.append(S),p.append(f),(l>0||c>0)&&o.next<.16*HOURS&&o.last>.5*HOURS?(p.addClass("green-bg"),d[o.name]||(!function(t,e){if(_)try{"granted"!==Notification.permission?Notification.requestPermission():new Notification("Profitable Bidding Opportunity!",{icon:"https://steembottracker.com/img/bot_logo.png",body:"@"+t+" is currently showing a profitable bidding opportunity! Max profitable bid is $"+e.formatMoney()+" SBD."})}catch(t){}}(o.name,l),d[o.name]=!0)):d[o.name]=!1,(100==o.power&&o.last>4*HOURS||o.power<90)&&p.addClass("red-light-bg"),$("#bots_table tbody").append(p)}catch(t){console.log("Error loading bot @"+o.name+", Error: "+t)}}function x(t){switch(n){case"SBD":return(t.vote_usd/sbd_price).formatMoney()+" SBD";case"STEEM":return(t.vote_usd/steem_price).formatMoney()+" STEEM";case"USD":return"$"+t.vote_usd.formatMoney();case"POST REWARDS":return"$"+t.vote.formatMoney()}}function y(t,e){return t.reduce(function(t,a){return t+(a.currency==e?parseFloat(a.amount):0)},0)}function w(t,a,o){o.forEach(function(r){var i=parseFloat(r.amount),s=getUsdValue(r),l=r.currency,c=$(document.createElement("tr")),d=$(document.createElement("td"));(f=$(document.createElement("a"))).attr("href","http://www.steemit.com/@"+r.sender),f.attr("target","_blank"),f.text("@"+r.sender),d.append(f),c.append(d),(d=$(document.createElement("td"))).text(i.formatMoney()+" "+l),d.css("text-align","right"),c.append(d),(d=$(document.createElement("td"))).text("$"+s.formatMoney()),d.css("text-align","right"),c.append(d);d=$(document.createElement("td"));var m=0;if(r.weight)m=r.weight/100;else if(a.max_roi){var u=a.vote_usd*e*((100-a.max_roi)/100),_=a.total_usd<u?a.total_usd/u:1;m=s/o.round_total*100*_}else m=s/o.round_total*100;d.text(m.formatMoney()+"%"),d.css("text-align","right"),c.append(d);var p=((r.weight?r.weight/1e4:m/100)*parseFloat(x(a).replace(/[$,]/g,""))).formatMoney();p="SBD"==n||"STEEM"==n?p+" "+n:"$"+p,(d=$(document.createElement("td"))).text(p),d.css("text-align","right"),c.append(d);d=$(document.createElement("td"));var f,g=$(document.createElement("div"));g.css("width","250px"),g.css("overflow","hidden"),g.css("height","23px"),(f=$(document.createElement("a"))).attr("href",r.url.startsWith("http")?r.url:"https://steemit.com"+r.url),f.attr("target","_blank"),f.text(r.url),g.append(f),d.append(g),c.append(d),t.append(c)})}function E(t){$("#bid_details_dialog_bot_name").text(t.name),$("#bid_details_error").hide(),$("#bid_details_btn_submit").off("click"),$("#bid_details_btn_submit").click(S),$("#bid_details_post_url").val(""),$("#bid_details_bid_amount").val(t.min_bid),$("#bid_details_bid_amount").attr("min",t.min_bid),(c=$("#bid_details_dialog").modal()).off("hidden.bs.modal"),c.bot=t,$("#bid_details_bid_currency").empty(),t.se_token?$("#bid_details_bid_currency").append('<option value="'+t.se_token+'">'+t.se_token+"</option>"):($("#bid_details_bid_currency").append('<option value="SBD">SBD</option>'),$("#bid_details_bid_currency").append('<option value="STEEM">STEEM</option>'));var e=l?l.name:localStorage.getItem("bid_details_account_name");e&&($("#bid_details_account_name").val(e),k())}function S(){var t=c.bot.payment_acct?c.bot.payment_acct:$("#bid_details_dialog_bot_name").text(),e=$("#bid_details_account_name").val(),a=$("#bid_details_bid_amount").val(),n=$("#bid_details_bid_currency").val(),o=$("#bid_details_post_url").val();!function(t,e,a,n,o){if("STEEM"==n&&!t.accepts_steem)return void o("This bot does not accept STEEM bids!");if("STEEM"==n&&parseFloat(a)<t.min_bid_steem)return void o("Bid is below the minimum, please bid "+t.min_bid_steem+" STEEM or more!");if("SBD"==n&&parseFloat(a)<t.min_bid)return void o("Bid is below the minimum, please bid "+t.min_bid+" SBD or more!");var r=e.substr(e.lastIndexOf("/")+1),i=e.substring(e.lastIndexOf("@")+1,e.lastIndexOf("/"));steem.api.getContent(i,r,function(e,a){if(!e&&a&&a.id>0){var n=new Date(a.created+"Z"),r=a.active_votes.filter(function(e){return e.voter==t.name}),i=r.length>0&&new Date-new Date(r[0].time+"Z")>12e5;i?o("This bot has already voted on this post!"):new Date-n>=24*t.max_post_age*60*60*1e3?o("This post is past the max age accepted by this bot!"):o(null)}else o("There was an error loading this post, please check the URL.")})}(c.bot,o,a,n,function(r){r?($("#bid_details_error").html("<b>Error:</b> "+r),$("#bid_details_error").show()):(console.log(1),function(t,e,a,n,o){if(["SBD","STEEM"].includes(n))window.steem_keychain?steem_keychain.requestTransfer(e,t,parseFloat(a).toFixed(3),o,n,t=>console.log(t)):popupCenter("https://v2.steemconnect.com/sign/transfer?from="+e+"&to="+t+"&amount="+a+" "+n+"&memo="+o,"sc2-pay",600,800);else{var r={contractName:"tokens",contractAction:"transfer",contractPayload:{symbol:n,to:t,quantity:a+"",memo:o}};if(window.steem_keychain)steem_keychain.requestCustomJson(e,"ssc-mainnet1","Active",JSON.stringify(r),"Token Transfer: "+n);else{var i="https://steemconnect.com/sign/custom-json?authority=active&required_posting_auths="+encodeURI("[]")+"&required_auths="+encodeURI('["'+e+'"]&id=ssc-mainnet1&json='+JSON.stringify(r));popupCenter(i,"sc2-pay",600,800)}}}(t,e,a,n,o),c.modal("hide"))})}function k(){var t=$("#bid_details_account_name").val(),e=$("#bid_details_recent_posts"),a=(new Date).getTime()-24*(c.bot.max_post_age?c.bot.max_post_age:6)*60*60*1e3;steem.api.getDiscussionsByAuthorBeforeDate(t,null,(new Date).toISOString().split(".")[0],5,function(t,n){var o=n.filter(function(t){return new Date(t.created).getTime()>a});o.length>0?e.empty():e.html("None Found"),o.forEach(function(t){var a=t.title.length>25?t.title.substring(0,22)+"...":t.title,n=$('<button type="button" class="btn btn-info btn-xs" style="margin: 0 5px;">'+a+"</button>");e.append(n),n.click(function(){$("#bid_details_post_url").val("https://steemit.com"+t.url)})})})}function M(t,e){var a=t.memo.substr(t.memo.lastIndexOf("/")+1),n=t.memo.substring(t.memo.lastIndexOf("@")+1,t.memo.lastIndexOf("/"));steem.api.getContent(n,a,function(a,n){if(!a&&n&&n.id>0){var o=n.active_votes.find(function(e){return e.voter==t.to});o&&(t.vote_rshares=o.rshares,t.vote_percent=o.percent),t.title=n.title}else console.log(a);e&&e()})}function T(t){var e=$("#user_bids_table tbody");e.empty(),$("#user_bids_name").text(l.name),t.reverse(),t.forEach(function(t){if(t.title){var a=parseFloat(t.amount),n=getUsdValue(t),o=getCurrency(t.amount),r=$(document.createElement("tr")),i=$(document.createElement("td"));(s=$(document.createElement("a"))).attr("href",t.memo),s.attr("target","_blank"),s.text(t.title.length>30?t.title.substr(0,30)+"...":t.title),i.append(s),r.append(i);var s;i=$(document.createElement("td"));(s=$(document.createElement("a"))).attr("href","https://steemit.com/@"+t.to),s.attr("target","_blank"),s.text("@"+t.to),i.append(s),r.append(i),(i=$(document.createElement("td"))).text(a.formatMoney()+" "+o+(t.refunded?" (refunded)":"")),i.css("text-align","right"),r.append(i),(i=$(document.createElement("td"))).text("$"+n.formatMoney()),i.css("text-align","right"),r.append(i),(i=$(document.createElement("td"))).text(t.refunded||!t.vote_rshares?"--":(t.vote_percent/100).formatMoney()+"%"),i.css("text-align","right"),r.append(i);var l=t.vote_rshares*rewardBalance/recentClaims*steemPrice;(i=$(document.createElement("td"))).text(t.refunded||!t.vote_rshares?"--":"$"+l.formatMoney()),i.css("text-align","right"),r.append(i),(i=$(document.createElement("td"))).text(t.refunded||!t.vote_rshares?"--":"$"+(l/2*sbd_price+l/2).formatMoney()),i.css("text-align","right"),r.append(i),(i=$(document.createElement("td"))).text(t.refunded||!t.vote_rshares?"--":(100*((l/2*sbd_price+l/2)/n-1)).formatMoney()+"%"),i.css("text-align","right"),r.append(i),e.append(r)}})}p(g),setInterval(p,3e4),f(),setInterval(f,6e5),updateSteemVariables(b),setInterval(b,6e5),setInterval(g,3e4),setInterval(updateTimers,1e3),function(){function t(t){s[t]=!s[t],$("#filter_"+t).css("border",s[t]?"2px solid green":"none"),h()}$("#curation_option").on("change",function(){e=this.checked?.5:1,h()}),$("#notification_option").on("change",function(){_=this.checked,localStorage.setItem("notifications_enabled",this.checked)}),localStorage.hasOwnProperty("notifications_enabled")&&(_="true"==localStorage.getItem("notifications_enabled"),$("#notification_option").attr("checked",_)),localStorage.hasOwnProperty("favorites")&&(m=localStorage.getItem("favorites").split(",")),localStorage.hasOwnProperty("hidden")&&(u=localStorage.getItem("hidden").split(",").filter(function(t){return""!=t})),$("#unhide_link a").click(function(){u=[],localStorage.setItem("hidden",""),h(),$("#unhide_link").hide()}),localStorage.hasOwnProperty("currency_list")?($("#currency_list").val(localStorage.getItem("currency_list")),n=localStorage.getItem("currency_list")):localStorage.setItem("currency_list","USD"),$("#currency_list").change(function(){n=$("#currency_list").val(),localStorage.setItem("currency_list",n),h()}),$("#min_vote_slider").slider(),$("#bid_details_account_name").on("change",function(t){localStorage.setItem("bid_details_account_name",$("#bid_details_account_name").val()),k()}),localStorage.hasOwnProperty("min_vote_slider")?($("#min_vote_slider").slider("setValue",localStorage.getItem("min_vote_slider")),a=parseFloat(localStorage.getItem("min_vote_slider"))):localStorage.setItem("min_vote_slider",a),$("#min_vote_slider").on("slide",function(t){t.value!=a&&(a=parseFloat(t.value),localStorage.setItem("min_vote_slider",t.value),h())}),$("#calculate_vote").click(function(){var t=null,a=$("#bot_list").val();o.forEach(function(e){e.name!=a||(t=e)});var n=$("#calc_currency").val(),r=parseFloat($("#bid_amount").val()),i="SBD"==n?r*sbd_price:r*steem_price,s=i/(i+t.total_usd)*t.vote_usd,l=i/(i+t.total_usd)*t.vote/2,c=i/(i+t.total_usd)*t.vote/2/steem_price;return $("#bid_value").text("$"+i.formatMoney()),$("#vote_value").text("$"+s.formatMoney()+" = "+l.formatMoney()+" SBD + "+c.formatMoney()+" STEEM"),$("#vote_value_net").text("$"+(s*e).formatMoney()+" = "+(l*e).formatMoney()+" SBD + "+(c*e).formatMoney()+" STEEM"),$("#vote_value").css("color",s>=i?"#008800":"#FF0000"),$("#vote_value_net").css("color",s*e>=i?"#008800":"#FF0000"),!1}),$("#close_peg_msg").click(function(){$("#peg_msg").hide(),localStorage.setItem("hide_peg_msg",!0)}),localStorage.hasOwnProperty("hide_peg_msg")&&$("#peg_msg").hide(),localStorage.hasOwnProperty("accept_disclaimer")||setTimeout(function(){$("#disclaimer").modal(),localStorage.setItem("accept_disclaimer",!0)},2e3),$("#filter_verified").click(function(){t("verified")}),$("#filter_refund").click(function(){t("refund")}),$("#filter_steem").click(function(){t("steem")}),$("#filter_se").click(function(){t("se")}),$("#filter_nocomment").click(function(){t("nocomment")}),$("#minnowbooster-submit").click(function(){E({name:"minnowbooster",min_bid:.01,max_post_age:6.3})}),$("#booster-submit").click(function(){E({name:"booster",min_bid:1,max_post_age:3.5})}),$("#tipu-submit").click(function(){E({name:"tipu",min_bid:.5,max_post_age:6,accepts_steem:!0})}),$("#therising-submit").click(function(){E({name:"therising",min_bid:.5,max_post_age:3.5,accepts_steem:!0})});var c=getURLParameter("access_token")?getURLParameter("access_token"):localStorage.getItem("access_token");sc2.init({baseURL:"https://v2.steemconnect.com",app:"bottracker.app",accessToken:c,callbackURL:"https://steembottracker.com",scope:["login","vote"]}),sc2.me(function(t,e){e&&!t?(console.log(e),l=e.account,$("#btn_login").hide(),$("#user_info").show(),$("#login_info").text("@"+l.name),localStorage.setItem("access_token",c)):($("#btn_login").show(),$("#user_info").hide())}),$("#btn_logout").click(function(){localStorage.removeItem("access_token"),window.location.href=window.location.pathname}),$("#btn_bid_history").click(function(){$("#user_bids").modal(),steem.api.getAccountHistory(l.name,-1,1e3,function(t,e){for(var a=[],n=0,r=0;r<e.length;r++){var i=e[r],s=i[1].op,l=s[1];if("transfer"==s[0]&&o.find(function(t){return t.name==l.to})){if(l.memo.lastIndexOf("/")<0||l.memo.lastIndexOf("@")<0)continue;a.push(l),M(l,function(){++n>=a.length&&(console.log(a),T(a))})}else if("transfer"==s[0]&&o.find(function(t){return t.name==l.from})){var l=a.find(function(t){return t.to==s[1].from&&t.amount==s[1].amount});l&&(l.refunded=!0)}}})}),$("#btn_front_run").click(function(){$.get(i+"/posts",function(t){var e=t,a=0;e.forEach(function(t){var n=t.permlink,o=t.author;steem.api.getContent(o,n,function(n,o){if(!n&&o&&o.id>0){t.created=new Date(o.created+"Z"),t.payout=parseFloat(o.pending_payout_value),t.title=o.title,t.author=o.author,t.permlink=o.permlink;var i=Math.min(new Date-new Date(o.created+"Z"),r)/r;t.curation_reward=(Math.sqrt(.25*(t.payout+1))-Math.sqrt(.25*t.payout))*Math.sqrt(.25*(t.payout+1+t.vote_value))*i,l&&(t.voted=null!=o.active_votes.find(function(t){return t.voter==l.name}))}++a>=e.length&&(e.sort(function(t,e){return parseFloat(e.curation_reward)-parseFloat(t.curation_reward)}),function(t){var e=$("#front_runner_table tbody");e.empty(),t.forEach(function(t){if(t.title){var a=$(document.createElement("tr")),n=$(document.createElement("td")),o=$(document.createElement("a"));o.attr("href","https://steemit.com/@"+t.author),o.attr("target","_blank"),o.text("@"+t.author),n.append(o),a.append(n);var n=$(document.createElement("td")),o=$(document.createElement("a"));o.attr("href","https://steemit.com"+t.url),o.attr("target","_blank"),o.text(t.title.length>40?t.title.substr(0,40)+"...":t.title),n.append(o),a.append(n);var n=$(document.createElement("td"));n.text("$"+t.payout.formatMoney()),n.css("text-align","right"),a.append(n);var n=$(document.createElement("td"));n.text("$"+parseFloat(t.amount).formatMoney()),n.css("text-align","right"),a.append(n);var n=$(document.createElement("td"));n.text("$"+t.vote_value.formatMoney()),n.css("text-align","right"),a.append(n);var n=$(document.createElement("td"));if(n.text("$"+t.curation_reward.formatMoney()+" / $1"),n.css("text-align","right"),a.append(n),n=$(document.createElement("td")),t.voted)n.text("Voted");else{var o=$('<button type="button" class="btn btn-info btn-xs"><i class="fa fa-thumbs-up mr5"></i>Upvote</button>');o.click(function(e){l?(n.empty(),n.text("Voting..."),sc2.vote(l.name,t.author,t.permlink,1e4,function(t,e){console.log(t,e),e&&!t?n.text("Success!"):(n.empty(),n.append(o))})):window.location.href=sc2.getLoginURL()}),n.append(o)}n.css("text-align","center"),a.append(n),e.append(a)}})}(e))})})}),$("#front_runner_dialog").modal()})}()});